%%%%%%%%%%%%%%%%Permutation entropy%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%author:lanlanli
%%%%%%%date:2010.09
%ï¿½Ã³ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Ðµï¿½Permutation_entropy
%&ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ë£ºAÎªï¿½ï¿½Òªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ý£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½FsÎªï¿½ï¿½ï¿½ï¿½Ä²ï¿½ï¿½ï¿½ï¿½ï¿?
%%ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Per_enï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ãµï¿½ï¿½ï¿½Permutationï¿½Øµï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½Ã¿window_t sï¿½ï¿½ï¿½ï¿½Ãµï¿½Ò»ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±Ã¿ï¿½ï¿½ï¿½Øµï¿½window_t/2 sï¿½ï¿½M_PÎª
%ï¿½ï¿½ï¿½Permutationï¿½Øµï¿½Æ½ï¿½ï¿½Öµ
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [Per_en,M_P]=Permutation_entropy(A)
%A=load(input);
Fs=250;
window_t=10;
%N=Fs*window_t;
N=length(A);
G=length(A);
g=Fs*(window_t/2);%Ã¿ï¿½Î»ï¿½ï¿½ï¿½ï¿½Äµï¿½ï¿½ï¿½
t=((G-N)/g);
h=floor(t);
tau=2;
m=6;
M=N-(m-1)*tau;%ï¿½ï¿½Õ¼ï¿½Ã¿Ò»Î¬ï¿½ï¿½ï¿½ÐµÄ³ï¿½ï¿½ï¿?
for ii=0:h %ï¿½ï¿½ï¿½ï¿½ï¿½Ä´ï¿½ï¿½ï¿½
    data=A(1+ii*g:N+ii*g);
    Y=reconstitution(data,N,m,tau)';%ï¿½Ø¹ï¿½ï¿½ï¿½Õ¼ï¿?
    [X,I]=sort(Y,2);%ï¿½ï¿½ï¿½Ø¹ï¿½ï¿½ï¿½Õ¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿?
    B=unique(I,'rows');%ï¿½Ò³ï¿½Iï¿½Ðµï¿½Ã¿Ò»ï¿½ï¿½ï¿½ï¿½ï¿½Ø¸ï¿½ï¿½ï¿½Ä£Ê½
    [Point,K]=size(B);
    C=zeros(Point,1);
    for i=1:Point
        for j=1:M
            if B(i,:)==I(j,:)
                C(i)=C(i)+1;%ï¿½ï¿½ï¿½ï¿½Ã¿ï¿½ï¿½Ä£Ê½ï¿½ï¿½ï¿½ÖµÄ´ï¿½ï¿½ï¿½
            end
        end
    end
    P_pi=C./M;%ï¿½ï¿½ï¿½ï¿½Ã¿ï¿½ï¿½Ä£Ê½ï¿½ï¿½ï¿½ÖµÄ¸ï¿½ï¿½ï¿½
    Log_pi=log(P_pi);
    H_m=-sum(P_pi.*Log_pi);
    Per_en(ii+1)=H_m/(m-1);%ï¿½ï¿½ï¿½ï¿½Permutation_entropy
end
%          PeRn=Per_en./log
M_P=mean(Per_en);








